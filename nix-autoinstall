#!/bin/sh


# Script to perform installation of Nix on MacOS
#

{ # Prevent execution if this script was only partially downloaded
oops() {
    echo "$0:" "$@" >&2
    exit 1
}

umask 0022

# Perform automated install
tmpDir="$(mktemp -d -t nixautoinstalldir.XXXXXXXXX || \
          oops "Can't create temporary directory for downloading the Nix install script")"

cleanup() {
    rm -rf "$tmpDir"
}
trap cleanup EXIT INT QUIT TERM
curl -L https://nixos.org/nix/install > "$tmpDir/nixinstall"
yes | sh "$tmpDir/nixinstall"

} # End of wrapping

